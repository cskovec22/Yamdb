# Проект «YaMDb»  
## Описание  
Проект **YaMDb** собирает отзывы пользователей на различные произведения. Сами произведения в **YaMDb** не хранятся, здесь нельзя посмотреть фильм или послушать музыку.  
Произведения делятся на категории, также им могут быть присвоены жанры.  
Добавлять произведения, категории и жанры может только администратор.  
Благодарные или возмущённые пользователи оставляют к произведениям текстовые отзывы и ставят произведению оценку в диапазоне от одного до десяти (целое число); из пользовательских оценок формируется усреднённая оценка произведения — рейтинг (целое число). На одно произведение пользователь может оставить только один отзыв.  
Пользователи могут оставлять комментарии к отзывам.  
Добавлять отзывы, комментарии и ставить оценки могут только аутентифицированные пользователи.  

## Как запустить проект:
Клонировать репозиторий и перейти в него в командной строке:  
```
https://github.com/cskovec22/api_yamdb
```
```
cd api_yamdb
```
Cоздать и активировать виртуальное окружение:
```
py -m venv venv
```
```
. venv/Scripts/activate
```
Установить зависимости из файла requirements.txt:
```
py -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```
Выполнить миграции:
```
py manage.py migrate
```
Для тестирования приложения можно заполнить базу данных контентом из приложенных csv-файлов:  
```
py manage.py importcsv
```
Запустить проект:
```
py manage.py runserver
```
## Алгоритм регистрации пользователей  
1. Пользователь отправляет POST-запрос на добавление нового пользователя с параметрами `email` и `username` на эндпоинт `/api/v1/auth/signup/`.  
1. **YaMDB** отправляет письмо с кодом подтверждения (`confirmation_code`) на адрес `email`.  
1. Пользователь отправляет POST-запрос с параметрами `username` и `confirmation_code` на эндпоинт `/api/v1/auth/token/`, в ответе на запрос ему приходит `token`.  
1. При желании пользователь отправляет PATCH-запрос на эндпоинт `/api/v1/users/me/` и заполняет поля в своём профайле.  
### Пользовательские роли  
- **Аноним** — может просматривать описания произведений, читать отзывы и комментарии.  
- **Аутентифицированный пользователь** (`user`) — может, как и **Аноним**, читать всё, дополнительно он может публиковать отзывы и ставить оценку произведениям (фильмам/книгам/песенкам), может комментировать чужие отзывы; может редактировать и удалять **свои** отзывы и комментарии. Эта роль присваивается по умолчанию каждому новому пользователю.  
- **Модератор** (`moderator`) — те же права, что и у **Аутентифицированного пользователя** плюс право удалять **любые** отзывы и комментарии.  
- **Администратор** (`admin`) — полные права на управление всем контентом проекта. Может создавать и удалять произведения, категории и жанры. Может назначать роли пользователям.  
- **Суперюзер Django** — обладет правами администратора (`admin`).  
## Примеры запросов к API:  
### Регистрация нового пользователя  
Получить код подтверждения на переданный `email`. Права доступа: **Доступно без токена**. Использовать имя 'me' в качестве `username` запрещено. Поля `email` и `username` должны быть уникальными. Должна быть возможность повторного запроса кода подтверждения.  
```
POST /api/v1/auth/signup/
```
Образец запроса:  
```
{
  "email": "user@example.com",
  "username": "string"
}
```
### Получение токена
Получение токена в обмен на `username` и `confirmation code`. Права доступа: **Доступно без токена**.  
```
POST /api/v1/auth/token/
```
Образец запроса:  
```
{
  "email": "user@example.com",
  "username": "string"
}
```
Образец ответа:  
```
{
  "token": "string"
}
```
### Получение списка всех категорий  
Получить список всех категорий. Права доступа: **Доступно без токена**.  
```
GET /api/v1/categories/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "name": "string",
      "slug": "string"
    }
  ]
}
```
### Добавление новой категории  
Создать категорию. Права доступа: **Администратор**. Поле `slug` каждой категории должно быть уникальным.  
```
POST /api/v1/categories/
```
Образец запроса:  
```
{
  "name": "string",
  "slug": "string"
}
```
### Удаление категории  
Удалить категорию. Права доступа: **Администратор**.  
```
DELETE /api/v1/categories/{slug}/
```
### Получение списка всех жанров  
Получить список всех жанров. Права доступа: **Доступно без токена**.  
```
GET /api/v1/genres/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "name": "string",
      "slug": "string"
    }
  ]
}
```
### Добавление жанра  
Добавить жанр. Права доступа: **Администратор**. Поле `slug` каждого жанра должно быть уникальным.  
```
POST /api/v1/genres/
```
Образец запроса:  
```
{
  "name": "string",
  "slug": "string"
}
```
### Удаление жанра  
Удалить жанр. Права доступа: **Администратор**.  
```
DELETE /api/v1/genres/{slug}/
```
### Получение списка всех произведений  
Получить список всех объектов. Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "id": 0,
      "name": "string",
      "year": 0,
      "rating": 0,
      "description": "string",
      "genre": [
        {
          "name": "string",
          "slug": "string"
        }
      ],
      "category": {
        "name": "string",
        "slug": "string"
      }
    }
  ]
}
```
### Добавление произведения  
Добавить новое произведение. Права доступа: **Администратор**. Нельзя добавлять произведения, которые еще не вышли (год выпуска не может быть больше текущего). При добавлении нового произведения требуется указать уже существующие категорию и жанр.  
```
POST /api/v1/titles/
```
Образец запроса:  
```
{
  "name": "string",
  "year": 0,
  "description": "string",
  "genre": [
    "string"
  ],
  "category": "string"
}
```
### Получение информации о произведении  
Информация о произведении Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/{titles_id}/
```
Образец ответа:  
```
{
  "id": 0,
  "name": "string",
  "year": 0,
  "rating": 0,
  "description": "string",
  "genre": [
    {
      "name": "string",
      "slug": "string"
    }
  ],
  "category": {
    "name": "string",
    "slug": "string"
  }
}
```
### Частичное обновление информации о произведении  
Обновить информацию о произведении Права доступа: **Администратор**.  
```
PATCH /api/v1/titles/{titles_id}/
```
### Удаление произведения  
Удалить произведение. Права доступа: **Администратор**.  
```
DELETE /api/v1/titles/{titles_id}/
```
### Получение списка всех отзывов  
Получить список всех отзывов. Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/{title_id}/reviews/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "id": 0,
      "text": "string",
      "author": "string",
      "score": 1,
      "pub_date": "2023-12-19T14:15:22Z"
    }
  ]
}
```
### Добавление нового отзыва  
Добавить новый отзыв. Пользователь может оставить только один отзыв на произведение. Права доступа: **Аутентифицированные пользователи**.  
```
POST /api/v1/titles/{title_id}/reviews/
```
Образец запроса:  
```
{
  "text": "string",
  "score": 1
}
```
Образец ответа:  
```
{
  "id": 0,
  "text": "string",
  "author": "string",
  "score": 1,
  "pub_date": "2023-12-19T14:15:22Z"
}
```
### Полуение отзыва по id  
Получить отзыв по id для указанного произведения. Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/{title_id}/reviews/{review_id}/
```
Образец ответа:  
```
{
  "id": 0,
  "text": "string",
  "author": "string",
  "score": 1,
  "pub_date": "2023-12-19T14:15:22Z"
}
```
### Частичное обновление отзыва по id  
Частично обновить отзыв по id. Права доступа: **Автор отзыва**, **модератор** или **администратор**.  
```
PATCH /api/v1/titles/{title_id}/reviews/{review_id}/
```
### Удаление отзыва по id  
Удалить отзыв по id. Права доступа: **Автор отзыва**, **модератор** или **администратор**.  
```
DELETE /api/v1/titles/{title_id}/reviews/{review_id}/
```
### Получение списка всех комментариев к отзыву  
Получить список всех комментариев к отзыву по id. Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "id": 0,
      "text": "string",
      "author": "string",
      "pub_date": "2023-12-19T14:15:22Z"
    }
  ]
}
```
### Добавление комментария к отзыву  
Добавить новый комментарий для отзыва. Права доступа: **Аутентифицированные пользователи**.  
```
POST /api/v1/titles/{title_id}/reviews/{review_id}/comments/
```
Образец запроса:  
```
{
  "text": "string"
}
```
Образец ответа:  
```
{
  "id": 0,
  "text": "string",
  "author": "string",
  "pub_date": "2023-12-19T14:15:22Z"
}
```
### Получение комментария к отзыву  
Получить комментарий для отзыва по id. Права доступа: **Доступно без токена**.  
```
GET /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/
```
Образец ответа:  
```
{
  "id": 0,
  "text": "string",
  "author": "string",
  "pub_date": "2019-08-24T14:15:22Z"
}
```
### Частичное обновление комментария к отзыву  
Частично обновить комментарий к отзыву по id. Права доступа: **Автор комментария**, **модератор** или **администратор**.  
```
PATCH /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/
```
### Удаление комментария к отзыву  
Удалить комментарий к отзыву по id. Права доступа: **Автор комментария**, **модератор** или **администратор**.  
```
DELETE /api/v1/titles/{title_id}/reviews/{review_id}/comments/{comment_id}/
```
### Получение списка всех пользователей  
Получить список всех пользователей. Права доступа: **Администратор**.  
```
GET /api/v1/users/
```
Образец ответа:  
```
{
  "count": 0,
  "next": "string",
  "previous": "string",
  "results": [
    {
      "username": "string",
      "email": "user@example.com",
      "first_name": "string",
      "last_name": "string",
      "bio": "string",
      "role": "user"
    }
  ]
}
```
### Добавление пользователя  
Добавить нового пользователя. Права доступа: **Администратор**. Поля `email` и `username` должны быть уникальными.  
```
POST /api/v1/users/
```
Образец запроса:  
```
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```
### Получение пользователя по username  
Получить пользователя по `username`. Права доступа: **Администратор**.  
```
GET /api/v1/users/{username}/
```
Образец ответа:  
```
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```
### Изменение данных пользователя по username  
Изменить данные пользователя по `username`. Права доступа: **Администратор**. Поля `email` и `username` должны быть уникальными.  
```
PATCH /api/v1/users/{username}/
```
### Удаление пользователя по username  
Удалить пользователя по `username`. Права доступа: **Администратор**.  
```
DELETE /api/v1/users/{username}/
```
### Получение данных своей учетной записи  
Получить данные своей учетной записи Права доступа: **Любой авторизованный пользователь**.  
```
GET /api/v1/users/me/
```
Образец ответа:  
```
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```
### Изменение данных своей учетной записи  
Изменить данные своей учетной записи. Права доступа: **Любой авторизованный пользователь**. Поля `email` и `username` должны быть уникальными.  
```
PATCH /api/v1/users/me/
```
Пример запроса:  
```
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string"
}
```
Пример ответа:  
```
{
  "username": "string",
  "email": "user@example.com",
  "first_name": "string",
  "last_name": "string",
  "bio": "string",
  "role": "user"
}
```
### Разработчики  
1. Булат Бубеев:  
   - система регистрации и аутентификации;  
   - права доступа;  
   - работа с токеном;  
   - система подтверждения через e-mail.  
2. Дмитрий Лифенко:  
   - модели, view и эндпойнты для произведений, категорий и жанров;  
   - реализация импорта данных из csv файлов.
3. Никита Васин:  
   - модели, view и эндпойнты для отзывов и комментариев;  
   - рейтинг произведений.